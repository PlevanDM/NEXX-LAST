# üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Cloudflare API

## –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞–Ω–Ω—è API Token

### –í–∞—Ä—ñ–∞–Ω—Ç A: API Token (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞: https://dash.cloudflare.com/profile/api-tokens
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create Token"**
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —à–∞–±–ª–æ–Ω **"Edit Cloudflare Workers"** –∞–±–æ **"Custom token"**
4. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø—Ä–∞–≤–∞:
   - **Account** ‚Üí **Cloudflare Pages** ‚Üí **Edit**
   - **Account** ‚Üí **Workers Scripts** ‚Üí **Edit** (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
   - **Zone** ‚Üí **Zone Settings** ‚Üí **Read** (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
5. –°–∫–æ–ø—ñ—é–π—Ç–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Ç–æ–∫–µ–Ω (–ø–æ–∫–∞–∑—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑!)

### –í–∞—Ä—ñ–∞–Ω—Ç B: Global API Key (–∑–∞—Å—Ç–∞—Ä—ñ–ª–∏–π)

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞: https://dash.cloudflare.com/profile/api-tokens
2. –ó–Ω–∞–π–¥—ñ—Ç—å —Å–µ–∫—Ü—ñ—é **"API Keys"**
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"View"** –±—ñ–ª—è **"Global API Key"**
4. –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
5. –°–∫–æ–ø—ñ—é–π—Ç–µ –∫–ª—é—á

## –ö—Ä–æ–∫ 2: –û—Ç—Ä–∏–º–∞–Ω–Ω—è Account ID

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞: https://dash.cloudflare.com/
2. –í–∏–±–µ—Ä—ñ—Ç—å —Å–≤—ñ–π –∞–∫–∞—É–Ω—Ç
3. –£ –ø—Ä–∞–≤–æ–º—É –±—ñ—á–Ω–æ–º—É –º–µ–Ω—é –∑–Ω–∞–π–¥—ñ—Ç—å **"API"** —Å–µ–∫—Ü—ñ—é
4. –°–∫–æ–ø—ñ—é–π—Ç–µ **"Account ID"**

## –ö—Ä–æ–∫ 3: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É

### –í–∞—Ä—ñ–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env`:

```env
CLOUDFLARE_API_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_—Ç—É—Ç
CLOUDFLARE_EMAIL=dmitro.plevan@gmail.com
CLOUDFLARE_ACCOUNT_ID=–≤–∞—à_account_id
```

### –í–∞—Ä—ñ–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Wrangler secrets

```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ API —Ç–æ–∫–µ–Ω
wrangler secret put CLOUDFLARE_API_TOKEN
# (–≤–≤–µ–¥—ñ—Ç—å —Ç–æ–∫–µ–Ω –ø—Ä–∏ –∑–∞–ø–∏—Ç—ñ)

# –ê–±–æ –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
wrangler login
```

## –ö—Ä–æ–∫ 4: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –¢–µ—Å—Ç —á–µ—Ä–µ–∑ Node.js
npm run test:cf-api

# –ê–±–æ —á–µ—Ä–µ–∑ PowerShell
.\test-cloudflare-api.ps1
```

## –ö—Ä–æ–∫ 5: –û–Ω–æ–≤–ª–µ–Ω–Ω—è wrangler.toml

–í—ñ–¥–∫—Ä–∏–π—Ç–µ `wrangler.toml` —Ç–∞ –¥–æ–¥–∞–π—Ç–µ Account ID:

```toml
account_id = "–≤–∞—à_account_id_—Ç—É—Ç"
```

## üîç Troubleshooting

### –ü–æ–º–∏–ª–∫–∞ "Invalid request headers"

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω—É
- API Token –º–∞—î –±—É—Ç–∏ –¥–æ–≤–≥–∏–º (40+ —Å–∏–º–≤–æ–ª—ñ–≤)
- Global API Key –º–∞—î –±—É—Ç–∏ –∫–æ—Ä–æ—Ç—à–∏–º
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ email –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π

### –ü–æ–º–∏–ª–∫–∞ "Authentication error"

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ —Ç–æ–∫–µ–Ω –Ω–µ –∑–∞—Å—Ç–∞—Ä—ñ–≤
- –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π —Ç–æ–∫–µ–Ω –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ç–æ–∫–µ–Ω –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ Pages/Workers

### –ü–æ–º–∏–ª–∫–∞ "Forbidden"

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ —Ç–æ–∫–µ–Ω—É
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ç–æ–∫–µ–Ω –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤
- –°–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–æ–∫–µ–Ω –∑ –±—ñ–ª—å—à–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏

## üìö –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

- [Cloudflare API Documentation](https://developers.cloudflare.com/api/)
- [Creating API Tokens](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/)
- [Wrangler Authentication](https://developers.cloudflare.com/workers/wrangler/configuration/#using-environment-variables)
